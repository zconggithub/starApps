<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>starApp</title>

<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" />
<link th:href="@{/font-awesome/css/font-awesome.css}" rel="stylesheet" />

<!-- Toastr style -->
<link th:href="@{/css/plugins/toastr/toastr.min.css}" rel="stylesheet"/>

<link th:href="@{/css/style.css}" rel="stylesheet" />
    <link th:href="@{/css/plugins/select2/select2.min.css}" rel="stylesheet" />


</head>

<body>

    <div id="wrapper">
		<nav class="navbar-default navbar-static-side" role="navigation" th:include="nav :: navigation"></nav>
		<div id="page-wrapper" class="gray-bg">
        	<div class="border-bottom" th:include="header :: headerTop"></div>
      		<div class="row wrapper border-bottom white-bg page-heading" th:fragment="headerNav">
		   		<div class="col-lg-10">
		     		<h2>数据源上传</h2>
		          	<ol class="breadcrumb">
			            <li>
			            	<a href="#">首页</a>
			            </li>
			            <li>
			            	<a>数据元管理</a>
			         	</li>
			         	<li>
			             	<a></a>
			          	</li>
			          	<li class="active">
			             	<strong>数据-导入</strong>
			          	</li>
					</ol>
		      	</div>
		      	<div class="col-lg-2">
		      	</div>
		  	</div>
        	<div class="wrapper wrapper-content animated fadeInRight">
            
            
            
            <div class="row">
                <!--###############3-->
                <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h5>上传文件</h5>
                        </div>

                        <div class="ibox-content">
                            <form id="excelImport" action="/starApp/importExcel" method="POST" class="form-horizontal" enctype="multipart/form-data">
                                <input type="hidden" name="id"  />
                                <input type="hidden" name="image"  />
                                <div class="form-group"><label class="col-sm-2 control-label" style="height: 40%">数据元：</label>
                                    <div class="col-sm-2 m-b-xs">
                                        <select name="dataSource_type" id="dataSource2" class="form-control">
                                                <option value=""></option>
                                            	<option value="StandardSubject">企业科目与标准科目</option>
                                               <option value="StandardSubjectFinance">标准科目与财务报表</option>
                                               <option value="Subject">科目</option>

                                        </select>
                                    </div>
                                </div>

                                <div id="imputCell1" class="form-group"><label class="col-sm-2 control-label"><!--图片：--></label>
                                    <div class="col-sm-10">
                                        <input id="import_file" type="file" name="file" multiple="multiple"/>
                                    </div>
                                </div>

                              <div class="hr-line-dashed"></div>
                                <div class="form-group">
                                    <div class="col-sm-4 col-sm-offset-2">
                                        <button id="importFile" class="btn btn-primary"  type="submit">&nbsp;&nbsp;&nbsp;&nbsp;提&nbsp;&nbsp;&nbsp;&nbsp;交&nbsp;&nbsp;&nbsp;&nbsp;</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        <div class="row"><!--数据元维护-->
             <!--@@@@@@@@@@@@@@@@@@数据元维护：添加@@@@@@@@@@@@@@@@@@@@@@-->
                <div class="col-lg-6">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h5>数据元维护</h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </div>
                        </div>
                        <div class="ibox-content">
                            <form id="formTag" action="newsCategoryEdit" method="POST" class="form-horizontal" enctype="multipart/form-data">

                                <div class="form-group"><label class="col-sm-3 control-label">数据元名称：</label>
                                    <div class="col-sm-6">
                                        <input id="name" name="name" type="text" class="form-control" />
                                    </div>
                                </div>
                                <div class="form-group"><label class="col-sm-3 control-label">描述：</label>
                                    <div class="col-sm-6">
                                        <textarea id="description" name="description" class="form-control" rows="2"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-4 col-sm-offset-2">
                                        <button id="submitButton" class="btn btn-primary" type="button">&nbsp;&nbsp;&nbsp;&nbsp;提&nbsp;&nbsp;&nbsp;&nbsp;交&nbsp;&nbsp;&nbsp;&nbsp;</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
               <!--@@@@@@@@@@@@@@@@@@数据元维护：列表@@@@@@@@@@@@@@@@@@@@@@-->
                <div class="col-lg-6">
                    <div class="ibox float-e-margins" >
                        <div class="ibox-title">
                            <h5>数据元列表</h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                                <div class="ibox-content">
                                    <table class="table table-hover no-margins">
                                        <thead>
                                        <tr>
                                            <th>数据元名称</th>
                                            <th>描述</th>
                                            <th>创建时间</th>
                                            <th>修改时间</th>
                                            <th>操作</th>
                                        </tr>
                                        </thead>
                                    </table>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
        </div>

            </div>
        	<!--<div class="footer" th:include="footer :: copyright"></div>-->
      	</div>
	</div>
	
    <!-- Mainly scripts -->
    <script th:src="@{/js/jquery-2.1.1.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
    <script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>
    <script th:src="@{/js/plugins/select2/select2.full.min.js}"></script>
    <!-- Peity -->
    <script th:src="@{/js/plugins/peity/jquery.peity.min.js}"></script>
	
    <!-- Custom and plugin javascript -->
    <script th:src="@{/js/inspinia.js}"></script>
    <script th:src="@{/js/plugins/pace/pace.min.js}"></script>
    
    <!-- Toastr script -->
    <script th:src="@{/js/plugins/toastr/toastr.min.js}"></script>
    
    <!-- common -->
    <script th:src="@{/js/common.js}"></script>
    
    

    
    <script>
		$(document).ready(function () {
            //下拉框数据:数据导入部分
            $("#dataSource2").select2({
                placeholder: "请选择数据元",
            });
            $("#importFile").click(function () {
                if ($("#dataSource2").val() == "") {
                    toastr.error('请选择数据元', '提示')
                    return false;
                }
                if($("#import_file").val()==""){
                    toastr.error('请选择文件', '提示')
                    return false;
                }
                //判断文件格式是否正确
                if($("#import_file").val()!=""){
                    var filename = $("#import_file").val();//获取文件名
                    var fileTypes = new Array("xls","xlsx","csv","CSV"); //定义可支持的文件类型数组
                    var index1=filename.lastIndexOf(".");
                    var index2=filename.length;
                    var suffix=filename.substring(index1+1,index2);//后缀名
                    var file_type_Flag=false;
                    for ( var index in fileTypes){
                       // console.log(fileTypes[index]);
                        if(suffix==fileTypes[index]){
                           file_type_Flag=true;
                           break;
                        }
                    }
                    if(!file_type_Flag){
                        toastr.error('文件格式不正确，只支持[xls,xlsx,csv]', '提示')
                        return false;
                    }
                }
                $("#excelImport").submit();
            });
            //上传文件源，即源维护==》对应后台表，对数据元维护
            $("#submitButton").click(function () {
                if ($("#name").val() == "") {
                    toastr.error('请输入分类名称', '提示')
                    return;
                }
                if ($("#description").val() == "") {
                    toastr.error('请输入分类描述', '提示')
                    return;
                }
                $("#formTag").submit();
            });
        });


    </script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        var message = [[${importSuccessFlag}]];
        console.log(message);
        /*]]>*/
        if(message) {
            if(message.indexOf("OK")!=-1){
            toastr.success(message, '提示')
            }else {
                toastr.error(message, '提示')
            }
        }
    </script>



</body>

</html>
